### Cross-origin resource sharing(CORS) on K8S Ingress Nginx

nginx.ingress.kubernetes.io/enable-cors: If set to true enables CORS for all HTTP Frontend. By default CORS is disabled.
nginx.ingress.kubernetes.io/cors-allow-headers: Specifies allowed headers when CORS enabled. Default value is DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization.
nginx.ingress.kubernetes.io/cors-allow-methods: Specifies allowed methods when CORS enabled. Default value is GET,PUT,POST,DELETE,PATCH,OPTIONS.
nginx.ingress.kubernetes.io/cors-allow-origin: Specifies allowed origins when CORS enabled. Default value is *.

Using ingress-nginx on Kubernetes makes adding CORS headers painless. Kubernetes ingress-nginx uses annotations as a quick way to allow you to specify the automatic generation of an extensive list of common nginx configuration options.

You can check the nginx configuration file generated by Kubernetes ingress-nginx on any of the ingress controller pods.

If you set up the standard Kubernetes ingress-nginx on your cluster, you should have one or more controller pods running in the ingress-nginx namespace.

```
kubectl get pods -n ingress-nginx

NAME                                      READY     STATUS    RESTARTS   AGE
default-http-backend-5c6d95c48-xvs55      1/1       Running   0          26d
nginx-ingress-controller-f5676dc7-5ks6q   1/1       Running   0          26d
nginx-ingress-controller-f5676dc7-cjl6l   1/1       Running   0          26d
nginx-ingress-controller-f5676dc7-kthxn   1/1       Running   0          26d
nginx-ingress-controller-f5676dc7-rvhbv   1/1       Running   0          26d
```

# Pick a controller and cat the nginx configuration:

```
# pipe the config to less or your favorite text reader
kubectl exec -n ingress-nginx \
    nginx-ingress-controller-f5676dc7-kthxn \
    cat /etc/nginx/nginx.conf | less
```

# You can see that ingress-nginx created some header directives for nginx:

```
...
more_set_headers 'Access-Control-Allow-Credentials: true';
...
```

### About CORS

CORS, or Cross-origin resource sharing consists of a few HTTP response headers intended to let a web browser know if it’s ok to POST data to a specific endpoint. Before a web browser lets Javascript issue a POST to a URL, then performs a “preflight” request. A preflight request is merely a request to the server with the same URL using the method OPTIONS rather than POST. The web browser checks the HTTP headers for CORS related headers to determine if POSTing data on behalf of the user is ok.
